# –Ø–¥—Ä–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ‚Äî –≠—Ç–∞–ø 1 (–¥–µ–º–æ –±–µ–∑ UI)

## –ß—Ç–æ —ç—Ç–æ
–ë–∞–∑–æ–≤—ã–π –º–æ–¥—É–ª—å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Ç–µ–º–∞, —Ü–µ–ª—å, –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞, —Ç–æ–Ω, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –æ–±—ä—ë–º)
–∏ —Å–æ–±–∏—Ä–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –º–æ–¥–µ–ª–∏.

## –§–∞–π–ª—ã
- `config.py` ‚Äî –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
- `helpers.py` ‚Äî —É—Ç–∏–ª–∏—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
- `rules_engine.py` ‚Äî —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–º–ø—Ç–∞ (`build_prompt(data)`).
- `base_prompt.txt` ‚Äî —à–∞–±–ª–æ–Ω –ø—Ä–æ–º–ø—Ç–∞.
- `input_example.json` ‚Äî –ø—Ä–∏–º–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
- `run_demo.py` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ UI.
- `docs/implementation_overview.md` ‚Äî —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –æ–±–∑–æ—Ä–æ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```bash
python3 -m venv venv
# macOS/Linux:
source venv/bin/activate
# Windows (PowerShell):
# venv\Scripts\activate

python run_demo.py

```

## –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ API –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

```bash
# UI –∏ API –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ (Flask —Å–µ—Ä–≤–∏—Ç —Ñ—Ä–æ–Ω—Ç –∏ REST API)
python -m server

# –¢–æ–ª—å–∫–æ API (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–µ–∑ UI)
make api

# Flask-—Å–µ—Ä–≤–µ—Ä –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
make dev
```

### –ë—ã—Å—Ç—Ä—ã–π smoke-—Ç–µ—Å—Ç API

```bash
make health                 # /api/health
make reindex SMOKE_THEME=finance   # /api/reindex (—Ç–µ–º–∞—Ç–∏–∫–∞ –∑–∞–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ SMOKE_THEME)
make generate-dry SMOKE_THEME=finance  # /api/generate –≤ dry-run —Ä–µ–∂–∏–º–µ
```

> –í `generate-dry` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –º–æ–¥–µ–ª—å ‚Äî –∏–º —É–¥–æ–±–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥/–±—ç–∫–µ–Ω–¥ —Å–≤—è–∑–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏

- –í–æ –≤–∫–ª–∞–¥–∫–µ ¬´–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã¬ª –∫–∞–∂–¥–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–ª—É—á–∏–ª–∞ –∫–Ω–æ–ø–∫—É ¬´–£–¥–∞–ª–∏—Ç—å¬ª. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º—É —É–¥–∞–ª–µ–Ω–∏—é `.md` –∏ `.json` –∏–∑ `artifacts/`, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é –∏–Ω–¥–µ–∫—Å–∞ –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–º—É —Å–∫—Ä—ã—Ç–∏—é –∫–∞—Ä—Ç–æ—á–∫–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–æ—Å—Ç ¬´–£–¥–∞–ª–µ–Ω–æ¬ª.
- –ï—Å–ª–∏ —Ñ–∞–π–ª —É–∂–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–¥–∞–ª—ë–Ω –≤—Ä—É—á–Ω—É—é), –ø–æ–ø—ã—Ç–∫–∞ –æ—Ç–∫—Ä—ã—Ç—å –∏–ª–∏ —Å–∫–∞—á–∞—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –∫—Ä–∞—Å–Ω—É—é –æ—à–∏–±–∫—É: –∫–∞—Ä—Ç–æ—á–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å—á–µ–∑–∞–µ—Ç, –∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º—è–≥–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ¬´–§–∞–π–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: –∑–∞–ø–∏—Å—å —É–¥–∞–ª–µ–Ω–∞ –∏–∑ —Å–ø–∏—Å–∫–∞¬ª.
- –ö–Ω–æ–ø–∫–∞ ¬´–û—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç reconcile/cleanup ‚Äî —Å–µ—Ä–≤–µ—Ä —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∏–Ω–¥–µ–∫—Å —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º `artifacts/` –∏ —É–¥–∞–ª—è–µ—Ç –æ—Å–∏—Ä–æ—Ç–µ–≤—à–∏–µ –∑–∞–ø–∏—Å–∏. –¢–∞ –∂–µ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ `/api/artifacts`, –ø–æ—ç—Ç–æ–º—É –±–∏—Ç—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∏—Å—á–µ–∑–∞—é—Ç –ª–µ–Ω–∏–≤–æ –∏ –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏.
- –í REST API –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã:
  - `DELETE /api/artifacts` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç JSON —Å `id` –∏/–∏–ª–∏ `path`, —É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª—ã –∏ –∑–∞–ø–∏—Å—å –≤ –∏–Ω–¥–µ–∫—Å–µ. –í –æ—Ç–≤–µ—Ç–µ –ø—Ä–∏—Ö–æ–¥—è—Ç —Ñ–ª–∞–≥–∏ `deleted`, `not_found`, `index_updated` –∏ –º–∞—Å—Å–∏–≤ `errors` (–ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω—ã—Ö —Å–±–æ—è—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è HTTP 207). –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ ID –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã.
  - `POST /api/artifacts/cleanup` ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä—É—á–Ω—É—é –æ—á–∏—Å—Ç–∫—É, –≤–æ–∑–≤—Ä–∞—â–∞—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö (`checked`) –∏ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö (`removed`) –∑–∞–ø–∏—Å–µ–π –∏ —Å–ø–∏—Å–æ–∫ `removed_ids`.

## –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–í UI –±–ª–æ–∫ ¬´–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏¬ª —Å–≤–µ—Ä–Ω—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `localStorage`) –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- **–ö–æ–Ω—Ç–µ–∫—Å—Ç (k)** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–ø–æ–≤ Retrieval. –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω 2‚Äì4; –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è 0‚Äì6. –ó–Ω–∞—á–µ–Ω–∏–µ 0 –≤—ã–∫–ª—é—á–∞–µ—Ç RAG.
- **Temperature** ‚Äî ¬´—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞¬ª LLM. –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 0.2‚Äì0.5. –î–æ–ø—É—Å—Ç–∏–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω 0‚Äì1.
- **Max tokens** ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –æ—Ç–≤–µ—Ç–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 1400; –ø—Ä–∏–Ω–∏–º–∞–π—Ç–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–ª—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
- **–ú–æ–¥–µ–ª—å** ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ–≤–µ—Ä—Ä–∞–π–¥ –º–æ–¥–µ–ª–∏. –û—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî `gpt-5`).

–ö–Ω–æ–ø–∫–∏ ¬´Reindex theme¬ª –∏ ¬´Health check¬ª –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ —Å–µ–∫—Ü–∏—é ¬´–°–ª—É–∂–µ–±–Ω–æ–µ/–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞¬ª –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞. –û–Ω–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `SHOW_DEV_ACTIONS=true`; –∏–Ω–∞—á–µ –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∫–∞–∫ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.

## RAG-ready (Stage 1)

### Profiles layout
- `profiles/<theme>/exemplars/` ‚Äî —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –ø–æ 200‚Äì700 —Å–ª–æ–≤ (–æ–¥–Ω–æ –∫–ª—é—á–µ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —Ñ–∞–π–ª, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π Markdown). –ü—Ä–∏–º–µ—Ä: `profiles/finance/exemplars/{001_intro.md, 002_benefits.md, 003_faq.md}`.
- `profiles/<theme>/glossary.txt` ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π.
- `profiles/<theme>/style_guide.md` ‚Äî —Ç–æ–Ω, do/don't, –ø–æ–ª–∏—Ç–∏–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏.
- `profiles/<theme>/style_samples/` ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç—Ç–∞–ª–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –≤ Markdown, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ (`.docx`, `.pdf` –∏ —Ç. –ø.).
- `profiles/<theme>/style_profile.md` ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–¥–∞—á–∏: —Ä–∞–∑–¥–µ–ª—ã ¬´–ö–∞–∫ –ø–∏—Å–∞—Ç—å¬ª, ¬´–ö–∞–∫ –Ω–µ –ø–∏—Å–∞—Ç—å¬ª, —Å—Å—ã–ª–∫–∏ –Ω–∞ —ç—Ç–∞–ª–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã.

### –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –±–µ–∑ LLM
- `assemble_messages.py` ‚Äî —Å–æ–±–∏—Ä–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç `CONTEXT`, –∫–æ–≥–¥–∞ `retrieve_exemplars()` –Ω–∞—á–Ω—ë—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã.
- `retrieve_exemplars(theme_slug, query, k=3)` ‚Äî –∫–æ–Ω—Ç—Ä–∞–∫—Ç Stage 2: –¥–æ–ª–∂–µ–Ω –æ—Ç–¥–∞–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π –≤–∏–¥–∞ `{ "path": str, "text": str, "score": float }`, –ø–æ–¥–æ–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–¥ —Ç–æ–∫–µ–Ω-–±—é–¥–∂–µ—Ç (~500‚Äì700 —Ç–æ–∫–µ–Ω–æ–≤ —Å—É–º–º–∞—Ä–Ω–æ).
- –ò—Ç–æ–≥–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π: `[{"role": "system", ...}, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π CONTEXT, {"role": "user", "content": "–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π —Ç–µ–∫—Å—Ç –ø–æ —É–∫–∞–∑–∞–Ω–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º."}]`.

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Stage 1
- `python run_demo.py` ‚Äî –±–∞–∑–æ–≤—ã–π –ø–æ—Ç–æ–∫ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π).
- `python validate_prompt.py` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å–µ–∫—Ü–∏–π –∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –≤ –ø—Ä–æ–º–ø—Ç–µ.
- `python assemble_messages.py` ‚Äî –ø–µ—á–∞—Ç–∞–µ—Ç –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä system –∏ CONTEXT (–ø–æ–∫–∞ –ø—É—Å—Ç–æ).
- `python prompt_to_file.py` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–º–ø—Ç –≤ `./artifacts/prompt_<timestamp>.txt`.

### –°–∫–≤–æ–∑–Ω–æ–π –ø—Ä–æ–≥–æ–Ω —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å—Ç–∞—Ç—å–∏
1. –°–æ–±–µ—Ä–∏ –∏–Ω–¥–µ–∫—Å (–æ–¥–∏–Ω —Ä–∞–∑ –∏–ª–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–ª–∏–ø–æ–≤): `python -m retrieval index --theme finance`
2. –ó–∞–ø—É—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é: `python orchestrate.py --theme finance --data input_example.json --k 3`
3. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–º–æ—Ç—Ä–∏ –≤ `artifacts/*.md` –∏ —Å–æ—Å–µ–¥–Ω–µ–º `.json` —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏.

#### –ü—Ä–∏–º–µ—Ä –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ `batch.json` —Å –º–∞—Å—Å–∏–≤–æ–º –∑–∞–¥–∞–Ω–∏–π (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å YAML —Å —Ç–µ–º–∏ –∂–µ –ø–æ–ª—è–º–∏):

```json
[
  {
    "theme": "finance",
    "data": "input_example.json",
    "k": 0,
    "outfile": "artifacts/finance_draft.md"
  },
  {
    "theme": "finance",
    "data": "input_example.json",
    "k": 3,
    "outfile": "artifacts/finance_context.md"
  },
  {
    "theme": "mortgage",
    "data": "mock_data/mortgage.json",
    "k": 2,
    "outfile": "artifacts/mortgage.md"
  }
]
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –æ–¥–Ω–∏–º –≤—ã–∑–æ–≤–æ–º:

```bash
python orchestrate.py --batch batch.json --mode draft
```

–ö–∞–∂–¥–æ–µ –∑–∞–¥–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç —Å—Ç–∞—Ç—å—é –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π `outfile` –∏ —Å–æ—Å–µ–¥–Ω–∏–π `.json`.

#### A/B —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –±–µ–∑ –∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

–ß—Ç–æ–±—ã —Å—Ä–∞–≤–Ω–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –±–µ–∑ CONTEXT –∏ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º `k`, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∂–∏–º `--ab compare`:

```bash
python orchestrate.py --theme finance --data input_example.json --k 3 --ab compare
```

–í –∫–∞—Ç–∞–ª–æ–≥–µ `artifacts/` –ø–æ—è–≤—è—Ç—Å—è —Ñ–∞–π–ª—ã —Å —Å—É—Ñ—Ñ–∏–∫—Å–∞–º–∏ `__A` (–±–µ–∑ CONTEXT) –∏ `__B` (—Å CONTEXT),
–∞ —Ä—è–¥–æ–º —Å –∫–∞–∂–¥—ã–º ‚Äî `.json` —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏. –ö–æ–º–∞–Ω–¥–∞ –≤—ã–≤–æ–¥–∏—Ç –¥–ª–∏–Ω—ã –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±–æ–∏—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è.

### Ready for Stage 2, –∫–æ–≥–¥–∞
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π —Å–æ–∑–¥–∞–Ω–∞ –º–∏–Ω–∏–º—É–º –¥–ª—è –æ–¥–Ω–æ–π —Ç–µ–º—ã —Å 2‚Äì3 –∑–∞–≥–æ—Ç–æ–≤–∫–∞–º–∏.
- `base_prompt.txt` –∑–Ω–∞–µ—Ç –ø—Ä–æ –±–ª–æ–∫ CONTEXT.
- –°—É—â–µ—Å—Ç–≤—É—é—Ç —Å—Ç–∞–±—ã `retrieve_exemplars` –∏ `assemble_messages` –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
- –í –ø—Ä–æ–µ–∫—Ç –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —Å–µ—Ç–µ–≤—ã–µ –≤—ã–∑–æ–≤—ã.

## üí¨ –°—Ç–∏–ª–µ–≤—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏

–í —Ñ–∞–±—Ä–∏–∫–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å—Ç–∏–ª–µ–≤—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ–º–∞—Ç–∏–∫. –î–ª—è —Ç–µ–º—ã Finance –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —ç—Ç–∞–ª–æ–Ω–Ω—ã–π —Å—Ç–∏–ª—å —Å –∫–æ—Ä–æ—Ç–∫–∏–º–∏ –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏ –∏ —á—ë—Ç–∫–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏. –û—Ç–∫–ª—é—á–∏—Ç—å –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `style_profile=off` –∏–ª–∏ –æ–¥–Ω–æ–∏–º—ë–Ω–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è.

### –ö–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∏–ª—å Finance
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–µ —ç—Ç–∞–ª–æ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ `profiles/finance/exemplars/` (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–æ–ø—É—Å—Ç–∏–º—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä `.docx`).
2. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç—ã –≤ Markdown –∏ –ø–æ–ª–æ–∂–∏—Ç–µ —Ñ–∞–π–ª—ã –≤ `profiles/finance/style_samples/`. –ù–∞–∑–≤–∞–Ω–∏—è ‚Äî –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ, –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤.
3. –û–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ —Å—Å—ã–ª–∫–∏ –≤–Ω—É—Ç—Ä–∏ `profiles/finance/style_profile.md` (—Ä–∞–∑–¥–µ–ª—ã ¬´–ö–∞–∫ –ø–∏—Å–∞—Ç—å/–Ω–µ –ø–∏—Å–∞—Ç—å¬ª –∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–º–µ—Ä–æ–≤).
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `Reindex theme` –¥–ª—è `finance` ‚Äî –∫–Ω–æ–ø–∫—É –≤ UI –∏–ª–∏ `make reindex SMOKE_THEME=finance`. –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∫—ç—à —Å—Ç–∏–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è: –Ω–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ –ø—Ä–∏–º–µ—Ä—ã —Å—Ä–∞–∑—É –ø–æ–ø–∞–¥—É—Ç –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç.

> –ü–æ–¥–º–µ—à–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫—Ä–∞—Ç–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å: —Å–∞–º–∏ Markdown-–ø—Ä–∏–º–µ—Ä—ã –≤ –ø—Ä–æ–º–ø—Ç –Ω–µ –≤—Å—Ç–∞–≤–ª—è—é—Ç—Å—è, –Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã –∞–≤—Ç–æ—Ä–∞–º –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è.

## Troubleshooting

- **OpenAI key** ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `OPENAI_API_KEY` –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º `python -m server`. UI –ø–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç—É—Å ¬´OpenAI key –Ω–µ –Ω–∞–π–¥–µ–Ω¬ª, –µ—Å–ª–∏ –∫–ª—é—á –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.
- **–ò–Ω–¥–µ–∫—Å** ‚Äî –µ—Å–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∞ Health –≥–æ–≤–æ—Ä–∏—Ç `index missing`, —Å–æ–±–µ—Ä–∏—Ç–µ –∏–Ω–¥–µ–∫—Å: `python -m retrieval index --theme <slug>`. –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–Ω–æ–ø–∫–æ–π ¬´Health check¬ª.
- **–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã** ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `artifacts/` –¥–æ–ª–∂–Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –∏ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–π –Ω–∞ –∑–∞–ø–∏—Å—å. –°–æ–∑–¥–∞–π—Ç–µ –µ—ë –≤—Ä—É—á–Ω—É—é (`mkdir -p artifacts`), –µ—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤–ø–µ—Ä–≤—ã–µ.
- **CORS / —É–¥–∞–ª—ë–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø** ‚Äî —Å–µ—Ä–≤–µ—Ä —É–∂–µ –æ—Ç–¥–∞—ë—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ CORS –¥–ª—è `/api/*`. –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –Ω–∞ –¥—Ä—É–≥–æ–º —Ö–æ—Å—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `python -m server --host 0.0.0.0 --port 8000` –∏ –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ UI –ø–æ `http://<host>:<port>`.

